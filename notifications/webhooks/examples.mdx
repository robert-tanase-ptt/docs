---
title: "Webhook examples"
description: "Practical examples for webhook integrations"
---

## Receiving Webhooks

### Python Flask Example

```python
from flask import Flask, request, jsonify
import hmac
import hashlib

app = Flask(__name__)
WEBHOOK_SECRET = "your-secret"

def verify_signature(payload, signature):
    expected = hmac.new(
        WEBHOOK_SECRET.encode(),
        payload,
        hashlib.sha256
    ).hexdigest()
    return hmac.compare_digest(f"sha256={expected}", signature)

@app.route('/webhook', methods=['POST'])
def webhook():
    signature = request.headers.get('X-Webhook-Signature')

    if not verify_signature(request.data, signature):
        return jsonify({"error": "Invalid signature"}), 401

    data = request.json
    event = data['event']

    if event == 'finding.new':
        handle_new_finding(data['data'])
    elif event == 'scan.completed':
        handle_scan_complete(data['data'])

    return jsonify({"status": "ok"})

def handle_new_finding(finding):
    print(f"New {finding['severity']} finding: {finding['title']}")
    # Your logic here

def handle_scan_complete(scan):
    print(f"Scan {scan['id']} completed")
    # Your logic here
```

### Node.js Express Example

```javascript
const express = require('express');
const crypto = require('crypto');

const app = express();
const WEBHOOK_SECRET = 'your-secret';

app.use(express.json({
  verify: (req, res, buf) => {
    req.rawBody = buf;
  }
}));

app.post('/webhook', (req, res) => {
  const signature = req.headers['x-webhook-signature'];
  const expected = `sha256=${crypto
    .createHmac('sha256', WEBHOOK_SECRET)
    .update(req.rawBody)
    .digest('hex')}`;

  if (signature !== expected) {
    return res.status(401).json({ error: 'Invalid signature' });
  }

  const { event, data } = req.body;

  switch (event) {
    case 'finding.new':
      console.log(`New finding: ${data.title}`);
      break;
    case 'scan.completed':
      console.log(`Scan completed: ${data.id}`);
      break;
  }

  res.json({ status: 'ok' });
});
```

## Integration Examples

### Send to Slack

```python
import requests

def handle_new_finding(finding):
    if finding['severity'] in ['critical', 'high']:
        slack_webhook = "https://hooks.slack.com/services/..."

        message = {
            "text": f"ðŸ”´ {finding['severity'].upper()}: {finding['title']}",
            "attachments": [{
                "color": "danger",
                "fields": [
                    {"title": "Asset", "value": finding['asset'], "short": True},
                    {"title": "Severity", "value": finding['severity'], "short": True}
                ]
            }]
        }

        requests.post(slack_webhook, json=message)
```

### Create GitHub Issue

```python
import requests

def handle_new_finding(finding):
    github_token = "your-token"
    repo = "owner/repo"

    issue = {
        "title": f"[Security] {finding['title']}",
        "body": f"**Severity**: {finding['severity']}\n**Asset**: {finding['asset']}\n\n{finding.get('description', '')}",
        "labels": ["security", finding['severity']]
    }

    requests.post(
        f"https://api.github.com/repos/{repo}/issues",
        headers={"Authorization": f"token {github_token}"},
        json=issue
    )
```

### Log to SIEM

```python
import requests
import json

def handle_all_events(event_data):
    siem_endpoint = "https://your-siem.com/api/events"

    siem_event = {
        "source": "pentest-tools",
        "event_type": event_data['event'],
        "timestamp": event_data['timestamp'],
        "data": event_data['data']
    }

    requests.post(siem_endpoint, json=siem_event)
```

## Testing Webhooks

### Local Testing with ngrok

```bash
# Start your local server
python app.py

# In another terminal, expose with ngrok
ngrok http 5000
```

Use the ngrok URL in your webhook configuration for testing.

<Tip>
Use request logging services like RequestBin or Webhook.site for debugging webhook payloads.
</Tip>

## Related Topics

- [Webhooks Overview](/notifications/webhooks/overview)
- [API Overview](/api-reference/overview)
