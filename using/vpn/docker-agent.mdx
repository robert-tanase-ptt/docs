---
title: "Docker agent"
description: "Deploy the VPN agent as a Docker container for internal network scanning"
---

## Overview

The Docker agent is a containerized VPN agent ideal for environments already using Docker or Kubernetes.

<Info>
VPN profiles require the **Internal network scanning** add-on.
</Info>

## Prerequisites

- Docker installed and running
- Outbound connectivity to vpn.pentest-tools.com on port 22
- Network access to internal targets from the Docker host

## Quick start

<Steps>
  <Step title="Create VPN profile">
    In Pentest-Tools.com, create a new VPN profile and copy the VPN UUID.
  </Step>
  <Step title="Pull the image">
    Download the agent Docker image.
  </Step>
  <Step title="Run the container">
    Start the agent container with your VPN UUID.
  </Step>
  <Step title="Verify connection">
    Confirm the agent is connected in your dashboard.
  </Step>
</Steps>

## Installation

### Pull the Image

```bash
docker pull pentesttoolscom/vpn_agent:latest
```

### Run the Agent

```bash
docker run -d \
  --name pentest-agent \
  --restart unless-stopped \
  --cap-add=NET_ADMIN \
  --device /dev/net/tun \
  pentesttoolscom/vpn_agent:latest <VPN_UUID>
```

<Note>
Replace `<VPN_UUID>` with the UUID from your VPN profile in the dashboard.
</Note>

## Required capabilities

The agent needs these Linux capabilities:

| Capability | Purpose |
|------------|---------|
| `NET_ADMIN` | Required for VPN tunnel management |
| `/dev/net/tun` | TUN device for VPN tunnel |

## Network modes

### Host network mode

For direct access to the host network:

```bash
docker run -d \
  --name pentest-agent \
  --network host \
  --cap-add=NET_ADMIN \
  --device /dev/net/tun \
  pentesttoolscom/vpn_agent:latest <VPN_UUID>
```

### Custom network

To scan containers in a specific Docker network:

```bash
docker run -d \
  --name pentest-agent \
  --network your-internal-network \
  --cap-add=NET_ADMIN \
  --device /dev/net/tun \
  pentesttoolscom/vpn_agent:latest <VPN_UUID>
```

## Docker Compose

```yaml
version: '3'
services:
  vpn-agent:
    image: pentesttoolscom/vpn_agent:latest
    container_name: pentest-agent
    restart: unless-stopped
    cap_add:
      - NET_ADMIN
    devices:
      - /dev/net/tun
    command: ["<VPN_UUID>"]
    network_mode: host
```

## Managing the Agent

```bash
# View logs
docker logs pentest-agent

# Check status
docker ps | grep pentest-agent

# Stop agent
docker stop pentest-agent

# Start agent
docker start pentest-agent

# Remove agent
docker rm -f pentest-agent
```

## Kubernetes deployment

For Kubernetes environments:

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: pentest-agent
spec:
  replicas: 1
  selector:
    matchLabels:
      app: pentest-agent
  template:
    metadata:
      labels:
        app: pentest-agent
    spec:
      containers:
      - name: agent
        image: pentesttoolscom/vpn_agent:latest
        args: ["<VPN_UUID>"]
        securityContext:
          capabilities:
            add: ["NET_ADMIN"]
        volumeMounts:
        - name: tun
          mountPath: /dev/net/tun
      volumes:
      - name: tun
        hostPath:
          path: /dev/net/tun
```

<Tip>
Use Kubernetes secrets to manage the VPN UUID securely.
</Tip>

## Troubleshooting

<AccordionGroup>
  <Accordion title="Container exits immediately">
    - Check if VPN UUID is provided as argument
    - Verify `--cap-add=NET_ADMIN` is set
    - Ensure `/dev/net/tun` device is mounted
    - Check container logs: `docker logs pentest-agent`
  </Accordion>
  <Accordion title="Cannot reach internal targets">
    - Verify container network mode allows access to targets
    - Check host firewall rules
    - Try `--network host` mode
  </Accordion>
</AccordionGroup>

## Related topics

- [VPN Profiles Overview](/using/vpn/overview)
- [Cloud Deployment](/using/vpn/cloud)
- [Troubleshooting](/using/vpn/troubleshooting)
