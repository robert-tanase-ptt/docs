---
title: "WAF Detector"
description: "Identify web application firewalls protecting target websites"
---

## Overview

The WAF Detector identifies whether a target website is protected by a Web Application Firewall (WAF) and attempts to determine which WAF product is in use. It can detect over **70 different WAF products** and even attempts to find the origin IP address to bypass the WAF.

The WAF Detector is a **discovery tool**: it identifies protection mechanisms but does not test for vulnerabilities. It does not add data to your [Attack Surface](/using/attack-surface/attack-surface-overview) or generate [findings](/using/findings/findings).

## Parameters

| Parameter | Description |
|-----------|-------------|
| Target URL | The URL of the website to scan. Must start with `http://` or `https://`. |

## How it works

The tool uses a multi-stage approach to detect WAF presence:

<Steps>
  <Step title="Heuristic attack">
    Sends a request containing a combined payload that simulates multiple attack types (XSS, SQLi, directory traversal, RCE, XXE). This is designed to trigger WAF responses.
  </Step>
  <Step title="Response analysis">
    Analyzes the response using pattern matching against 70+ known WAF signatures. Checks HTTP headers, response body, and status codes.
  </Step>
  <Step title="Generic detection">
    If no specific WAF is identified, performs additional tests to detect WAF behavior:
    - Removes User-Agent header and compares responses
    - Sends individual attack vectors (XSS, SQLi, directory traversal)
    - Checks for Server header changes after attacks
  </Step>
  <Step title="Origin IP search">
    If a WAF is detected, attempts to find the origin IP address that bypasses the WAF protection.
  </Step>
</Steps>

### Detection methods

The tool analyzes multiple signals to identify WAF presence:

| Method | What it detects |
|--------|-----------------|
| **Response patterns** | WAF-specific error pages, headers, and body content |
| **HTTP headers** | WAF signatures in Server, X-headers, and cookie headers |
| **Status code changes** | Different responses between normal and attack requests |
| **Server header changes** | Changes in the Server header after attack attempts |
| **Connection behavior** | Dropped connections or timeouts after attacks |

### Supported WAFs

The tool can identify 70+ WAF products, including major vendors like Cloudflare, AWS WAF, Akamai Kona, Imperva Incapsula, F5 BIG-IP ASM, Fortinet FortiWeb, Barracuda, Sucuri, ModSecurity, Wordfence, and many more.

<Note>
Detection is based on [identYwaf](https://github.com/stamparm/identYwaf) signatures.
</Note>

### Origin IP discovery

When a WAF is detected, the tool attempts to find the origin IP address. The server's real IP that might be accessible directly, bypassing the WAF:

| Method | Description |
|--------|-------------|
| **DNS records** | Extracts IP addresses from NS, MX, TXT, SOA, A, and AAAA records |
| **Favicon hash search** | Computes the favicon's MMH3 hash and searches Shodan for matching servers |
| **Shodan hostname search** | Searches Shodan for the target hostname |
| **SSL certificate fingerprint** | Finds servers with the same SSL certificate SHA1 fingerprint |

Each discovered IP is validated by:
1. Requesting the page with the original Host header
2. Comparing the response's HTML structure similarity (must be â‰¥90%)
3. Running WAF detection again to confirm bypass

## Why detect WAFs?

Understanding WAF presence helps you:

- **Adjust scanning strategy**: Slow down scans to avoid triggering rate limits
- **Interpret results accurately**: Distinguish WAF blocks from real vulnerabilities
- **Plan manual testing**: Use WAF bypass techniques where appropriate
- **Document infrastructure**: Include WAF details in penetration test reports
- **Reduce false negatives**: Know that some vulnerabilities may exist but be blocked

### Testing implications

**With WAF detected:**
- Scans may trigger blocks or rate limiting
- Expect more false negatives in vulnerability scans
- Some attack payloads will be filtered
- Consider using encoded or obfuscated payloads for manual testing
- Document the WAF in your final report

**No WAF detected:**
- Direct access to the application
- More accurate scan results expected
- Full payload testing possible
- Faster scanning without rate limiting concerns

<Tip>
When a WAF is detected, consider using the discovered origin IP (if found) to scan the application directly. However, always confirm you have authorization to test the origin server.
</Tip>

## Follow-up actions

Based on detection results:

| Result | Recommended action |
|--------|-------------------|
| WAF detected with origin IP | Consider scanning the origin IP directly with [Website Scanner](/tools/website-scanner) |
| WAF detected, no origin IP | Adjust scan settings to avoid rate limiting; use slower scan speeds |
| No WAF detected | Proceed with [Website Scanner](/tools/website-scanner) at normal speed |
| CDN detected | Run [Website Recon](/tools/website-recon) for additional technology fingerprinting |
| HTTPS endpoint | Run [SSL/TLS Scanner](/tools/ssl-tls-scanner) for certificate analysis (useful for origin IP discovery) |
